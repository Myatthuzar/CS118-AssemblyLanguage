
=SML
fun pair_with_first (x,[]) = [];
  | pair_with_first (x,y::ys) = (x,y)::pair_with_first (x,ys); 

fun cartesian ([],ys) = [];
  | cartesian (x:xs,ys) = pair_with_first (x,ys) @ cartesian (xs,ys);

val ps = [true,false];
val qs = [true,false];
cartesian (ps,qs); 

fun fmt s = TextIO.print (StringCut.padRight #" "8 s)
fun prt (lst : string list) = List.app fmt lst;
fun bools_to_list_of_strings f ((x:bool,y:bool)::xs) =
  "\" :: (Bool.toString x) :: (Bool.toString y)::
  (Bool.toString (f (x,y))) :: "\n" ::
  (bools_to_list_of_strings f xs)
 | bools_to_list_of_strings f _ = [];
fun pf(p,q) = p orelse q;
val tt = bools_to_list_of_strings pf (cartesian (ps,qs));
val sep = ["-----","------","-----","\n"];
val hdr = ["p","q","p or q","\n"];
prt (sep @ hdr @ sep @ tt @ ["\n"]);
